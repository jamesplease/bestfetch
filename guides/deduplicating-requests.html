<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/bestfetch/_next/static/css/fb32182904c4f90d6432.css" as="style"/><link rel="stylesheet" href="/bestfetch/_next/static/css/fb32182904c4f90d6432.css"/><link rel="preload" href="/bestfetch/_next/static/mXn-f5Cu9yG8TXNwgx7pp/pages/guides/deduplicating-requests.js" as="script"/><link rel="preload" href="/bestfetch/_next/static/mXn-f5Cu9yG8TXNwgx7pp/pages/_app.js" as="script"/><link rel="preload" href="/bestfetch/_next/static/runtime/webpack-b65cab0b00afd201cbda.js" as="script"/><link rel="preload" href="/bestfetch/_next/static/chunks/framework.4503cc20512dbab0b6d3.js" as="script"/><link rel="preload" href="/bestfetch/_next/static/chunks/6f6df73ecdfb4797eef2cad19f39081c87710443.791b498134cdc2a7a939.js" as="script"/><link rel="preload" href="/bestfetch/_next/static/chunks/683d6d613543a9967851cbf61ce3ba543577cfe2.207df265463aa9d141ae.js" as="script"/><link rel="preload" href="/bestfetch/_next/static/runtime/main-c7a2938b08979683a202.js" as="script"/></head><title>‚≠êÔ∏èbestfetch ‚≠êÔ∏è</title><body><div id="__next"><header class="header_header__3w6qi"><a class="header_logo__25JoG" href="/bestfetch/">‚≠êÔ∏è bestfetch</a><a class="header_githubLink__1pmaw" href="https://github.com/jamesplease/bestfetch">GitHub</a></header><div><nav class="nav_nav__2DIZA"><ul class="nav_navList__1XQQy"><li class="nav_navListItem__2RyNo"><a class="nav_navSectionLink__1KpdU" href="/">Home</a></li><li class="nav_navListItem__2RyNo"><a class="nav_navSectionLink__1KpdU" href="/getting-started">Getting Started</a></li><li class="nav_navListItem__2RyNo"><a class="nav_navSectionLink__1KpdU" href="/guides">Guides</a><ul class="nav_navSubList__1sPlE"><li><a class="nav_navLink__1mlDR" href="/guides/making-requests">Making Requests</a></li><li><a class="nav_navLink__1mlDR" href="/guides/caching-responses">Caching Responses</a></li><li><a class="nav_navLink__1mlDR" href="/guides/invalidating-the-cache">Invalidating the Cache</a></li><li><a class="nav_navLink__1mlDR activeNavLink" href="/guides/deduplicating-requests">Deduplicating Requests</a></li><li><a class="nav_navLink__1mlDR" href="/guides/other-response-types">Other Response Types</a></li><li><a class="nav_navLink__1mlDR" href="/guides/faq">FAQ</a></li></ul></li><li class="nav_navListItem__2RyNo"><a class="nav_navSectionLink__1KpdU" href="/api-reference">API</a><ul class="nav_navSubList__1sPlE nav_navApiSubList__15FUT"><li><a class="nav_navLink__1mlDR" href="/api-reference/bestfetch">bestfetch()</a></li><li><a class="nav_navLink__1mlDR" href="/api-reference/response-cache">responseCache</a></li><li><a class="nav_navLink__1mlDR" href="/api-reference/active-requests">activeRequests</a></li><li><a class="nav_navLink__1mlDR" href="/api-reference/cache-miss-error">CacheMissError</a></li><li><a class="nav_navLink__1mlDR" href="/api-reference/get-request-key">getRequestKey()</a></li></ul></li></ul></nav><div class="app_bodyContents__1IGMp"><div class="page"><h1>Deduplicating Requests</h1><p>bestfetch automatically prevents multiple identical requests from being made at the same time. It will batch all identical requests into a single request and then reuse the response.</p><p>This is best understood with an example. Consider the following fetch code:</p><pre class="lowlight"><code class="hljs js">fetch(<span class="hljs-string">&#x27;/api/books/2&#x27;</span>)
  .then(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;Received the book:&#x27;</span>, res);
  });

fetch(<span class="hljs-string">&#x27;/api/books/2&#x27;</span>)
  .then(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;Received the book:&#x27;</span>, res);
  });</code></pre><p>This code makes two requests to the same exact endpoint, and, accordingly, two network requests are made. Because these requests are targeting the same exact endpoint, it would be more efficient to make just one network request. That&#x27;s what bestfetch will do:</p><pre class="lowlight"><code class="hljs js">bestfetch(<span class="hljs-string">&#x27;/api/books/2&#x27;</span>)
  .then(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;Received the book:&#x27;</span>, res);
  });

<span class="hljs-comment">// This request will &quot;piggy-back&quot; on the previous one;</span>
<span class="hljs-comment">// a new network request is not made.</span>
bestfetch(<span class="hljs-string">&#x27;/api/books/2&#x27;</span>)
  .then(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;Received the book:&#x27;</span>, res);
  });</code></pre><h2>What Makes a Request Identical?</h2><p>This library looks at the following pieces of information about a request:</p><ul><li>The URL</li><li>The request body</li><li>The request method (i.e.; <code>GET</code>)</li><li>The <code>responseType</code></li></ul><p>Requests are only deduped when <b>all</b> of these things are identical between two or more requests.</p><h2>When is This Useful?</h2><p>The example code provided above may seem contrived. When would you ever make two requests back-to-back?</p><p>Consider an application that lets a user choose their country, where the list of countries is pulled from an API. You might choose to create a dropdown component that manages fetching its own list of countries.</p><p>If you only have one of these dropdowns on the page at a time, then you should have no problems. But if you were to render two of these dropdowns at the same time, then they would each would make a request to fetch the same list of countries.</p><p>One solution to avoid this inefficiency is hoist the call to fetch the countries outside of the dropdown, and then pass the response into the components. Sometimes, this solution is what is most appropriate.</p><p>Other times, you may not wish to, or you may be unable to, move the network call. Using bestfetch allows you to keep the network call in the component without worrying about how many instances of the component are on the page at one time.</p><h2>Disabling Deduplication</h2><p>Pass <code>dedupe: false</code> when calling <code>bestfetch</code> to disable request deduplication for a particular request.</p><pre class="lowlight"><code class="hljs js">bestfetch(<span class="hljs-string">&#x27;/api/books/2&#x27;</span>, { <span class="hljs-attr">dedupe</span>: <span class="hljs-literal">false</span> })
  .then(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;Received the book:&#x27;</span>, res);
  });</code></pre><h2>Configuring the Deduplication Behavior</h2><div class="advanced"><span class="emoji">üíÅ‚Äç‚ôÄÔ∏è</span> <b>Heads up!</b> This is an advanced API that very few applications should ever need to use. Be careful if you decide to use it in your app.</div><p>In rare situations, you may wish to have control over when two requests are considered to be identical. You can do this by specifying a<!-- --> <code>requestKey</code> when calling <code>bestfetch</code>. A<!-- --> <code>requestKey</code> is a string that bestfetch uses to determine when two requests are identical.</p><p>When two requests have the same key, then they are deduped. Additionally, the request key is used to determine when to pull from the cache.</p><p>By default, a <code>requestKey</code> is generated for you, but you may pass your own to override this behavior.</p><pre class="lowlight"><code class="hljs js">bestfetch(<span class="hljs-string">&#x27;/api/books/2&#x27;</span>, { <span class="hljs-attr">requestKey</span>: <span class="hljs-string">&#x27;my-custom-key&#x27;</span> })
  .then(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;Received the book:&#x27;</span>, res);
  });</code></pre></div><footer class="footer_footer__1tNtI"><span class="footer_footer_licenseText__1WWRm">bestfetch is licensed under the<!-- --> <a href="https://github.com/jamesplease/materialish/blob/master/LICENSE" class="footer_footer_licenseLink__dv4-a">MIT License</a>.</span><span class="footer_footer_licenseTextShort__3u4Up"><i class="zmdi zmdi-globe footer_icon"></i><a href="https://github.com/jamesplease/materialish/blob/master/LICENSE" class="footer_licenseLink footer_licenseLink-short">MIT License</a></span><a class="footer_footer_githubLink__U0tlu" href="https://github.com/jamesplease/materialish"><i class="zmdi zmdi-github footer_icon"></i> <span>View Project on GitHub</span></a></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/guides/deduplicating-requests","query":{},"buildId":"mXn-f5Cu9yG8TXNwgx7pp","assetPrefix":"/bestfetch","nextExport":true,"autoExport":true,"isFallback":false}</script><script nomodule="" src="/bestfetch/_next/static/runtime/polyfills-7db8ae5a1cf376e637ae.js"></script><script async="" data-next-page="/guides/deduplicating-requests" src="/bestfetch/_next/static/mXn-f5Cu9yG8TXNwgx7pp/pages/guides/deduplicating-requests.js"></script><script async="" data-next-page="/_app" src="/bestfetch/_next/static/mXn-f5Cu9yG8TXNwgx7pp/pages/_app.js"></script><script src="/bestfetch/_next/static/runtime/webpack-b65cab0b00afd201cbda.js" async=""></script><script src="/bestfetch/_next/static/chunks/framework.4503cc20512dbab0b6d3.js" async=""></script><script src="/bestfetch/_next/static/chunks/6f6df73ecdfb4797eef2cad19f39081c87710443.791b498134cdc2a7a939.js" async=""></script><script src="/bestfetch/_next/static/chunks/683d6d613543a9967851cbf61ce3ba543577cfe2.207df265463aa9d141ae.js" async=""></script><script src="/bestfetch/_next/static/runtime/main-c7a2938b08979683a202.js" async=""></script><script src="/bestfetch/_next/static/mXn-f5Cu9yG8TXNwgx7pp/_buildManifest.js" async=""></script><script src="/bestfetch/_next/static/mXn-f5Cu9yG8TXNwgx7pp/_ssgManifest.js" async=""></script></body></html>