(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{O2Tq:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/guides/caching-responses",function(){return t("fZZe")}])},YFqc:function(e,n,t){e.exports=t("cTJO")},cTJO:function(e,n,t){"use strict";var l=t("lwsE"),o=t("W8MJ"),i=t("a1gu"),r=t("Nsbk"),s=t("7W2i"),a=t("TqRt"),c=t("284h");n.__esModule=!0,n.default=void 0;var u,h=c(t("q1tI")),d=t("QmWs"),f=t("g/15"),p=a(t("nOHt"));function v(e){return e&&"object"===typeof e?(0,f.formatWithValidation)(e):e}var w=new Map,g=window.IntersectionObserver,m={};function y(){return u||(g?u=new g((function(e){e.forEach((function(e){if(w.has(e.target)){var n=w.get(e.target);(e.isIntersecting||e.intersectionRatio>0)&&(u.unobserve(e.target),w.delete(e.target),n())}}))}),{rootMargin:"200px"}):void 0)}var k=function(e){function n(e){var t;return l(this,n),(t=i(this,r(n).call(this,e))).p=void 0,t.cleanUpListeners=function(){},t.formatUrls=function(e){var n=null,t=null,l=null;return function(o,i){if(l&&o===n&&i===t)return l;var r=e(o,i);return n=o,t=i,l=r,r}}((function(e,n){return{href:v(e),as:n?v(n):n}})),t.linkClicked=function(e){var n=e.currentTarget,l=n.nodeName,o=n.target;if("A"!==l||!(o&&"_self"!==o||e.metaKey||e.ctrlKey||e.shiftKey||e.nativeEvent&&2===e.nativeEvent.which)){var i=t.formatUrls(t.props.href,t.props.as),r=i.href,s=i.as;if(function(e){var n=(0,d.parse)(e,!1,!0),t=(0,d.parse)((0,f.getLocationOrigin)(),!1,!0);return!n.host||n.protocol===t.protocol&&n.host===t.host}(r)){var a=window.location.pathname;r=(0,d.resolve)(a,r),s=s?(0,d.resolve)(a,s):r,e.preventDefault();var c=t.props.scroll;null==c&&(c=s.indexOf("#")<0),p.default[t.props.replace?"replace":"push"](r,s,{shallow:t.props.shallow}).then((function(e){e&&c&&(window.scrollTo(0,0),document.body.focus())}))}}},t.p=!1!==e.prefetch,t}return s(n,e),o(n,[{key:"componentWillUnmount",value:function(){this.cleanUpListeners()}},{key:"getPaths",value:function(){var e=window.location.pathname,n=this.formatUrls(this.props.href,this.props.as),t=n.href,l=n.as,o=(0,d.resolve)(e,t);return[o,l?(0,d.resolve)(e,l):o]}},{key:"handleRef",value:function(e){var n=this;this.p&&g&&e&&e.tagName&&(this.cleanUpListeners(),m[this.getPaths().join("%")]||(this.cleanUpListeners=function(e,n){var t=y();return t?(t.observe(e),w.set(e,n),function(){try{t.unobserve(e)}catch(n){console.error(n)}w.delete(e)}):function(){}}(e,(function(){n.prefetch()}))))}},{key:"prefetch",value:function(e){if(this.p){var n=this.getPaths();p.default.prefetch(n[0],n[1],e).catch((function(e){0})),m[n.join("%")]=!0}}},{key:"render",value:function(){var e=this,n=this.props.children,t=this.formatUrls(this.props.href,this.props.as),l=t.href,o=t.as;"string"===typeof n&&(n=h.default.createElement("a",null,n));var i=h.Children.only(n),r={ref:function(n){e.handleRef(n),i&&"object"===typeof i&&i.ref&&("function"===typeof i.ref?i.ref(n):"object"===typeof i.ref&&(i.ref.current=n))},onMouseEnter:function(n){i.props&&"function"===typeof i.props.onMouseEnter&&i.props.onMouseEnter(n),e.prefetch({priority:!0})},onClick:function(n){i.props&&"function"===typeof i.props.onClick&&i.props.onClick(n),n.defaultPrevented||e.linkClicked(n)}};return!this.props.passHref&&("a"!==i.type||"href"in i.props)||(r.href=o||l),h.default.cloneElement(i,r)}}]),n}(h.Component);n.default=k},fZZe:function(e,n,t){"use strict";t.r(n),t.d(n,"default",(function(){return d}));var l=t("q1tI"),o=t.n(l),i=t("10ji"),r=t.n(i),s=t("YFqc"),a=t.n(s),c=t("lxlk"),u=t.n(c),h=o.a.createElement;function d(){return h("div",{className:"page"},h("h1",null,"Caching Responses"),h("p",null,"bestfetch includes a sophisticated system for caching responses."),h("h2",null,"Configuring the Caching Behavior"),h("p",null,"Use the ",h("code",null,"cachePolicy")," option when calling"," ",h("code",null,"bestfetch()")," to control when the cache is used. Supported values are:"),h("ul",null,h("li",null,h("code",null,'"cache-first"'),": Requests will first look at the cache to see if a response for the same request key exists. If a response is found, then it will be returned, and no network request will be made. If no response exists in the cache, then a network request will be made."),h("li",null,h("code",null,'"network-only"'),": The cache is ignored, and a network request is always made."),h("li",null,h("code",null,'"cache-only"'),": If a response exists in the cache, then it will be returned. If no response exists in the cache, then the Promise will reject to a"," ",h(a.a,{href:"/api/cachemisserror"},h("a",null,"CacheMissError")),".")),h("p",null,"The following example shows how to specify the"," ",h("code",null,'"network-only"')," option:"),h(r.a,{language:"js",inline:!1,value:"bestfetch('/api/books/2', { cachePolicy: 'network-only' })\n  .then(res => {\n    console.log('Got the book', res.data);\n  });"}),h("h2",null,"The Default Behavior"),h("p",null,"The default value of ",h("code",null,"cache-policy")," is determined by the methed of the request:"),h("div",{className:u.a.grid},h("div",{className:u.a.gridTitle},"Method"),h("div",{className:u.a.gridTitle},h("code",null,"cachePolicy")),h("div",null,h("code",null,"GET")),h("div",null,h("code",null,'"cache-first"')),h("div",null,h("code",null,"POST")),h("div",null,h("code",null,'"network-only"')),h("div",null,h("code",null,"PUT")),h("div",null,h("code",null,'"network-only"')),h("div",null,h("code",null,"DELETE")),h("div",null,h("code",null,'"network-only"'))),h("p",null,"The default value for less commonly used methods is:"),h("div",{className:u.a.grid},h("div",{className:u.a.gridTitle},"Method"),h("div",{className:u.a.gridTitle},h("code",null,"cachePolicy")),h("div",null,h("code",null,"HEAD")),h("div",null,h("code",null,'"cache-first"')),h("div",null,h("code",null,"OPTIONS")),h("div",null,h("code",null,'"cache-first"'))),h("h2",null,"When to Change This Behavior"),h("p",null,'The default behavior is designed to work for traditional "RESTful" APIs. There are a couple of common situations where this default will not work, and where you will need to specify ',h("code",null,"cachePolicy")," ","yourself:"),h("ul",null,h("li",null,h("b",null,"GraphQL"),": many GraphQL implementations use ",h("code",null,"POST")," for all requests (queries and for mutations)."),h("li",null,h("b",null,"REST APIs"),": Sometimes, APIs will use ",h("code",null,"POST")," for retrieving data instead of ",h("code",null,"GET"),".")),h("h2",null,"Cache Invalidation"),h("p",null,"Responses that are added to the cache are ",h("b",null,"never")," invalidated unless you configure how you would like for them to be invalidated. For more, refer to the guide on"," ",h(a.a,{href:"/guides/invalidating-the-cache"},h("a",null,"invalidating cached responses")),"."))}},lxlk:function(e,n,t){e.exports={grid:"caching-responses_grid__jcBJ1",gridTitle:"caching-responses_gridTitle__nVNZF"}}},[["O2Tq",0,1,2,3]]]);